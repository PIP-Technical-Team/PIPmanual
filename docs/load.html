<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Load microdata and Auxiliary data | PIP Manual</title>
  <meta name="description" content="This is a manual to document all the technical and methodological decisions taken during the creation of packges for the PIP workflow." />
  <meta name="generator" content="bookdown 0.21.4 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Load microdata and Auxiliary data | PIP Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a manual to document all the technical and methodological decisions taken during the creation of packges for the PIP workflow." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Load microdata and Auxiliary data | PIP Manual" />
  
  <meta name="twitter:description" content="This is a manual to document all the technical and methodological decisions taken during the creation of packges for the PIP workflow." />
  

<meta name="author" content="DECIS" />
<meta name="author" content="Poverty GP" />


<meta name="date" content="2021-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="pcpipeline.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PIP Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="load.html"><a href="load.html"><i class="fa fa-check"></i><b>2</b> Load microdata and Auxiliary data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="load.html"><a href="load.html#auxiilary-data"><i class="fa fa-check"></i><b>2.1</b> Auxiilary data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="load.html"><a href="load.html#udpate-data"><i class="fa fa-check"></i><b>2.1.1</b> udpate data</a></li>
<li class="chapter" data-level="2.1.2" data-path="load.html"><a href="load.html#load-data"><i class="fa fa-check"></i><b>2.1.2</b> Load data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="load.html"><a href="load.html#microdata"><i class="fa fa-check"></i><b>2.2</b> Microdata</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="load.html"><a href="load.html#inventory-file"><i class="fa fa-check"></i><b>2.2.1</b> Inventory file</a></li>
<li class="chapter" data-level="2.2.2" data-path="load.html"><a href="load.html#finding-data"><i class="fa fa-check"></i><b>2.2.2</b> Finding data</a></li>
<li class="chapter" data-level="2.2.3" data-path="load.html"><a href="load.html#loading-data"><i class="fa fa-check"></i><b>2.2.3</b> Loading data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pcpipeline.html"><a href="pcpipeline.html"><i class="fa fa-check"></i><b>3</b> Poverty Calculator Pipeline (pre-computed estimations)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="pcpipeline.html"><a href="pcpipeline.html#folder-structure"><i class="fa fa-check"></i><b>3.1</b> Folder structure</a>
<ul>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#folders"><i class="fa fa-check"></i>Folders</a></li>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#files"><i class="fa fa-check"></i>Files</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="pcpipeline.html"><a href="pcpipeline.html#prerequisites-1"><i class="fa fa-check"></i><b>3.2</b> Prerequisites</a></li>
<li class="chapter" data-level="3.3" data-path="pcpipeline.html"><a href="pcpipeline.html#structure-of-the-_targets.r-file"><i class="fa fa-check"></i><b>3.3</b> Structure of the <code>_targets.R</code> file</a>
<ul>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#start-up"><i class="fa fa-check"></i>Start up</a></li>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#step-1-small-functions"><i class="fa fa-check"></i>Step 1: small functions</a></li>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#pipe-prepare-data"><i class="fa fa-check"></i>Step 2: prepare data</a></li>
<li class="chapter" data-level="3.3.1" data-path="pcpipeline.html"><a href="pcpipeline.html#step-3-the-actual-pipeline"><i class="fa fa-check"></i><b>3.3.1</b> Step 3: The actual pipeline</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="pcpipeline.html"><a href="pcpipeline.html#understanding-the-pipeline"><i class="fa fa-check"></i><b>3.4</b> Understanding the pipeline</a>
<ul>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#stem-targets"><i class="fa fa-check"></i>Stem targets</a></li>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#branches-targets"><i class="fa fa-check"></i>Branches targets</a></li>
<li class="chapter" data-level="" data-path="pcpipeline.html"><a href="pcpipeline.html#creating-the-cache-files"><i class="fa fa-check"></i>Creating the cache files</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="pcpipeline.html"><a href="pcpipeline.html#understanding-pipdm-functions"><i class="fa fa-check"></i><b>3.5</b> Understanding <code>{pipdm}</code> functions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="pcpipeline.html"><a href="pcpipeline.html#internal-structure-of-pipdm-functions"><i class="fa fa-check"></i><b>3.5.1</b> Internal structure of <code>{pipdm}</code> functions</a></li>
<li class="chapter" data-level="3.5.2" data-path="pcpipeline.html"><a href="pcpipeline.html#updating-pipdm-or-any-other-pip-package"><i class="fa fa-check"></i><b>3.5.2</b> Updating <code>{pipdm}</code> (or any other PIP package)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="pcpipeline.html"><a href="pcpipeline.html#executing-the-_targets.r-file"><i class="fa fa-check"></i><b>3.6</b> Executing the <code>_targets.R</code> file</a></li>
<li class="chapter" data-level="3.7" data-path="pcpipeline.html"><a href="pcpipeline.html#debugging"><i class="fa fa-check"></i><b>3.7</b> Debugging</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PIP Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="load" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Load microdata and Auxiliary data</h1>
<p>Make sure you have all the packages installed and loaded into memory. Given that they are hosted in Github, the code below makes sure that any package in the PIP workflow can be installed correctly.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="load.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First specify the packages of interest</span></span>
<span id="cb2-2"><a href="load.html#cb2-2" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;pipaux&quot;</span>, <span class="st">&quot;pipload&quot;</span>)</span>
<span id="cb2-3"><a href="load.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="load.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Now load or install&amp;load all</span></span>
<span id="cb2-5"><a href="load.html#cb2-5" aria-hidden="true" tabindex="-1"></a>package.check <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb2-6"><a href="load.html#cb2-6" aria-hidden="true" tabindex="-1"></a>  packages,</span>
<span id="cb2-7"><a href="load.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-8"><a href="load.html#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb2-9"><a href="load.html#cb2-9" aria-hidden="true" tabindex="-1"></a>      pck_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;PIP-Technical-Team/&quot;</span>, x)</span>
<span id="cb2-10"><a href="load.html#cb2-10" aria-hidden="true" tabindex="-1"></a>      devtools<span class="sc">::</span><span class="fu">install_github</span>(pck_name)</span>
<span id="cb2-11"><a href="load.html#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">library</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-12"><a href="load.html#cb2-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-13"><a href="load.html#cb2-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-14"><a href="load.html#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="auxiilary-data" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Auxiilary data</h2>
<p>Even though <code>pipaux</code> has more than 25 functions, most of its features
can be executed by using only the <code>pipaux::load_aux</code> and <code>pipaux::update_aux</code> functions.</p>
<div id="udpate-data" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> udpate data</h3>
<p>the main function of the <code>pipaux</code> package is <code>udpate_aux</code>. The first argument of this function is <code>measure</code> and it refers to the measure data to be loaded. The measures available are <strong>cpi, gdm, gdp, pce, pfw, pop, and ppp</strong>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="load.html#cb3-1" aria-hidden="true" tabindex="-1"></a>pipaux<span class="sc">::</span><span class="fu">update_aux</span>(<span class="at">measure =</span> <span class="st">&quot;cpi&quot;</span>)</span>
<span id="cb3-2"><a href="load.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; no labels available for measure `country_list`</span></span>
<span id="cb3-3"><a href="load.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; v CPI data is up to date</span></span></code></pre></div>
</div>
<div id="load-data" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Load data</h3>
<p>Loading auxiliary data is the job of the package <code>pipload</code> through the function <code>pipload::pip_load_aux()</code>, though <code>pipaux</code> also provides <code>pipaux::load_aux()</code> for the same purpose. Notice that, though both function do exactly the same, the loading function from <code>pipload</code> has the prefix <code>pip_</code> to distinguish it from the one in <code>pipaux</code>. However, we are going to limit the work of <code>pipaux</code> to update auxiliary data and the work of <code>pipload</code> to load data. Thus, all the examples below use <code>pipload</code> for loading either microdata or auxiliary data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="load.html#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> pipload<span class="sc">::</span><span class="fu">pip_load_aux</span>(<span class="at">measure =</span> <span class="st">&quot;cpi&quot;</span>)</span>
<span id="cb4-2"><a href="load.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; v Most recent version of data loaded</span></span>
<span id="cb4-3"><a href="load.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; //w1wbgencifs01/pip/PIP-Data_QA/_aux/cpi/cpi.fst</span></span>
<span id="cb4-4"><a href="load.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb4-5"><a href="load.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country_code cpi_year survey_year        cpi ccf survey_acronym change_cpi2011</span></span>
<span id="cb4-6"><a href="load.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:          AGO     2000     2000.21 0.03385145   1            HBS              0</span></span>
<span id="cb4-7"><a href="load.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:          AGO     2008     2008.50 0.72328920   1      IBEP-MICS              1</span></span>
<span id="cb4-8"><a href="load.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:          AGO     2018     2018.17 2.93543023   1          IDREA              1</span></span>
<span id="cb4-9"><a href="load.html#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:          ALB     1996     1996.00 0.44446184   1            EWS              1</span></span>
<span id="cb4-10"><a href="load.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:          ALB     2002     2002.00 0.78033877   1           LSMS              1</span></span>
<span id="cb4-11"><a href="load.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:          ALB     2005     2005.00 0.83852839   1           LSMS              1</span></span>
<span id="cb4-12"><a href="load.html#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       cpi2011 cpi_domain cpi_domain_value cpi2011_unadj cpi2011_AM20 cpi2011_unadj_AM20</span></span>
<span id="cb4-13"><a href="load.html#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: 0.03385145          1                1    0.03385145  0.033848061        0.033848061</span></span>
<span id="cb4-14"><a href="load.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: 0.72328920          1                1    0.72328920  0.723337197        0.723337197</span></span>
<span id="cb4-15"><a href="load.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3: 2.93543023          1                1    2.93543023  3.060594983        3.060594983</span></span>
<span id="cb4-16"><a href="load.html#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4: 0.44446184          1                1    0.44446184  0.444432734        0.444432734</span></span>
<span id="cb4-17"><a href="load.html#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5: 0.78033877          1                1    0.78033877  0.780287716        0.780287716</span></span>
<span id="cb4-18"><a href="load.html#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6: 0.83852839          1                1    0.83852839  0.838473458        0.838473458</span></span>
<span id="cb4-19"><a href="load.html#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    cpi2005_AM20 cpi_final_2019 cpi_data_level          cpi_id</span></span>
<span id="cb4-20"><a href="load.html#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  0.071889997             NA       national CPI_v05_M_v01_A</span></span>
<span id="cb4-21"><a href="load.html#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:  1.528669953             NA       national CPI_v05_M_v01_A</span></span>
<span id="cb4-22"><a href="load.html#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:           NA             NA       national CPI_v05_M_v01_A</span></span>
<span id="cb4-23"><a href="load.html#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:  0.530049980             NA       national CPI_v05_M_v01_A</span></span>
<span id="cb4-24"><a href="load.html#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:  0.950504005             NA       national CPI_v05_M_v01_A</span></span>
<span id="cb4-25"><a href="load.html#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:  1.000000000             NA       national CPI_v05_M_v01_A</span></span></code></pre></div>
</div>
</div>
<div id="microdata" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Microdata</h2>
<p>Loading PIP microdata is the most practical action in the <code>pipload</code> package. However, it is important to understand the logic of microdata.</p>
<p>PIP microdata has several characteristics,</p>
<ul>
<li>There could be more than once survey for each Country/Year. This happens when there are more than one welfare variable available such as income and consumption.</li>
<li>Some countries, like Mexico, have the two different welfare types in the same survey for the same country/year. This add a layer of complexity when the objective is to known which is default one.</li>
<li>There are multiple version of the same harmonized survey. These version are organized in a two-type vintage control. It is possible to have a new version of the data because the Raw data–the one provided by the official NSO–has been updated, or because there has been un update in the harmonization process.</li>
<li>Each survey could be use for more than one analytic tool in PIP (e.g., Poverty Calculator, Table Maker, or SOL). Thus, the data to be loaded depends on the tool in which it is going to be used.</li>
</ul>
<p>Thus, in order to make the process of finding and loading data efficiently, <code>pipload</code> is a three-step process.</p>
<div id="inventory-file" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Inventory file</h3>
<p>The inventory file resides in <code>y:/PIP-Data/_inventory/inventory.fst</code>. This file is a data frame with all the microdata available in the PIP structure. It has two main variables, <code>orig</code> and <code>filename</code>. The former refers to the full directory path of the database, whereas the latter is only the file name. the other variables in this data frame are derived from these two.</p>
<p>The inventory file is used to speed up the file searching process in <code>pipload</code>. In previous packages, each time the user wanted to find a particular data base, it was necessary to look into the folder structure and extract the name of all the file that meet a particular criteria. This is time-consuming and inefficient. The advantage of this method though, is that, by construction, it finds all the the data available. By contrast, the inventory file method is much faster than the “searching” method, as it only requires to load a light file with all the data available, filter the data, and return the required information. The drawback, however, is that it needs to be kept up to date as data changes constantly.</p>
<p>To update the inventory file, you need to use the function <code>pip_update_inventory</code>. If you don’t provide any argument, it will update the whole inventory, which may take around 10 to 15 min–the function will warn you about it. By provide the country/ies you want to update, the process is way faster.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="load.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># update one country</span></span>
<span id="cb5-2"><a href="load.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pip_update_inventory</span>(<span class="st">&quot;MEX&quot;</span>)</span>
<span id="cb5-3"><a href="load.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; i file inventory.fst is up to date.</span></span>
<span id="cb5-4"><a href="load.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; No update performed</span></span>
<span id="cb5-5"><a href="load.html#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="load.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load inventory file</span></span>
<span id="cb5-7"><a href="load.html#cb5-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">pip_load_inventory</span>()</span>
<span id="cb5-8"><a href="load.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df[, <span class="st">&quot;filename&quot;</span>])</span>
<span id="cb5-9"><a href="load.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                          filename</span></span>
<span id="cb5-10"><a href="load.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:       AGO_2000_HBS_V01_M_V01_A_PIP_PC-GPWG.dta</span></span>
<span id="cb5-11"><a href="load.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: AGO_2008_IBEP-MICS_V02_M_V02_A_PIP_PC-GPWG.dta</span></span>
<span id="cb5-12"><a href="load.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:  AGO_2008_IBEP-MICS_V02_M_V02_A_PIP_TB-ALL.dta</span></span>
<span id="cb5-13"><a href="load.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4:     AGO_2018_IDREA_V01_M_V01_A_PIP_PC-GPWG.dta</span></span>
<span id="cb5-14"><a href="load.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5:      AGO_2018_IDREA_V01_M_V01_A_PIP_TB-ALL.dta</span></span>
<span id="cb5-15"><a href="load.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:       ALB_1996_EWS_V01_M_V01_A_PIP_PC-HIST.dta</span></span></code></pre></div>
</div>
<div id="finding-data" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Finding data</h3>
<p>Every dataset in the PIP microdata repository is identified by seven variables! Country code, survey year, survey acronym, master version, alternative version, tool, and source. So giving the user the responsibility to know all the different combinations of each file is a heavy burden. Thus, the data finder, <code>pip_find_data()</code>, will provide the names of all the files available that meet the criteria in the arguments provided by the user. For instance, if the use wants to know the all the file available for Paraguay, we could type,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="load.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pip_find_data</span>(<span class="at">country =</span> <span class="st">&quot;PRY&quot;</span>)[[<span class="st">&quot;filename&quot;</span>]]</span>
<span id="cb6-2"><a href="load.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;PRY_1990_EH_V01_M_V02_A_PIP_PC-GPWG.dta&quot;  &quot;PRY_1995_EH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; </span></span>
<span id="cb6-3"><a href="load.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3] &quot;PRY_1997_EIH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_1999_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot;</span></span>
<span id="cb6-4"><a href="load.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;PRY_2001_EIH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2001_EIH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-5"><a href="load.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;PRY_2002_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2002_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-6"><a href="load.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;PRY_2003_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2003_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-7"><a href="load.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11] &quot;PRY_2004_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2004_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-8"><a href="load.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] &quot;PRY_2005_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2005_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-9"><a href="load.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15] &quot;PRY_2006_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2006_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-10"><a href="load.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17] &quot;PRY_2007_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2007_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-11"><a href="load.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] &quot;PRY_2008_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2008_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-12"><a href="load.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21] &quot;PRY_2009_EPH_V01_M_V06_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2009_EPH_V01_M_V06_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-13"><a href="load.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [23] &quot;PRY_2010_EPH_V01_M_V06_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2010_EPH_V01_M_V06_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-14"><a href="load.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25] &quot;PRY_2011_EPH_V01_M_V07_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2011_EPH_V01_M_V07_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-15"><a href="load.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [27] &quot;PRY_2012_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2012_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-16"><a href="load.html#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [29] &quot;PRY_2013_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2013_EPH_V01_M_V03_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-17"><a href="load.html#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31] &quot;PRY_2014_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2014_EPH_V01_M_V03_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-18"><a href="load.html#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [33] &quot;PRY_2015_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2015_EPH_V01_M_V03_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-19"><a href="load.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [35] &quot;PRY_2016_EPH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2016_EPH_V01_M_V02_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-20"><a href="load.html#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [37] &quot;PRY_2017_EPH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2017_EPH_V01_M_V02_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-21"><a href="load.html#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [39] &quot;PRY_2018_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2018_EPH_V01_M_V03_A_PIP_TB-ALL.dta&quot; </span></span>
<span id="cb6-22"><a href="load.html#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [41] &quot;PRY_2019_EPH_V01_M_V01_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2019_EPH_V01_M_V01_A_PIP_TB-ALL.dta&quot;</span></span></code></pre></div>
<p>Yet, if the user need to be more precise in its request, she can add information to the different arguments of the function. For example, this is data available in 2012,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="load.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pip_find_data</span>(<span class="at">country =</span> <span class="st">&quot;PRY&quot;</span>, </span>
<span id="cb7-2"><a href="load.html#cb7-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">year =</span> <span class="dv">2012</span>)[[<span class="st">&quot;filename&quot;</span>]]</span>
<span id="cb7-3"><a href="load.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;PRY_2012_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2012_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot;</span></span></code></pre></div>
</div>
<div id="loading-data" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Loading data</h3>
<p>Function <code>pip_load_data</code> takes care of loading the data. The very first instruction within <code>pip_load_data</code> is to find the data avialable in the repository by using <code>pip_load_inventory()</code>. The difference however is two-fold. First, <code>pip_load_data</code> will load the default and/or most recent version of the country/year combination available. Second, it gives the user the possibility to load different datasets in either list or dataframe form. For instance, if the user wants to load the Paraguay data in 2014 and 2015 used in the Poverty Calculator tool, she may type,</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="load.html#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="load.html#cb8-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">pip_load_data</span>(<span class="at">country =</span> <span class="st">&quot;PRY&quot;</span>,</span>
<span id="cb8-3"><a href="load.html#cb8-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year    =</span> <span class="fu">c</span>(<span class="dv">2014</span>, <span class="dv">2015</span>), </span>
<span id="cb8-4"><a href="load.html#cb8-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tool    =</span> <span class="st">&quot;PC&quot;</span>)</span>
<span id="cb8-5"><a href="load.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="load.html#cb8-6" aria-hidden="true" tabindex="-1"></a>i Loading data and creating a dataframe</span>
<span id="cb8-7"><a href="load.html#cb8-7" aria-hidden="true" tabindex="-1"></a>v Loading data and creating a dataframe ... done</span>
<span id="cb8-8"><a href="load.html#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="load.html#cb8-9" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">tabyl</span>(df, survey_id)</span>
<span id="cb8-10"><a href="load.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             survey_id     n    percent</span></span>
<span id="cb8-11"><a href="load.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  PRY_2014_EPH_V01_M_V03_A_PIP_PC-GPWG 20109 0.39548834</span></span>
<span id="cb8-12"><a href="load.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  PRY_2015_EPH_V01_M_V03_A_PIP_PC-GPWG 30737 0.60451166</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pcpipeline.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PIPmanual.pdf", "PIPmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
