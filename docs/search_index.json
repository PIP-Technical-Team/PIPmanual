[
["index.html", "PIP Manual Prerequisites", " PIP Manual DECIS Poverty GP 2020-09-21 Prerequisites You need to make sure the bookdown package is installed in your computer install.packages(&quot;bookdown&quot;) # or the development version devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. "],
["intro.html", "Chapter 1 Introduction", " Chapter 1 Introduction PIP workflow is … "],
["load.html", "Chapter 2 Load microdata and Auxiliary data 2.1 Auxiilary data 2.2 Microdata", " Chapter 2 Load microdata and Auxiliary data Make sure you have all the packages installed and loaded into memory. Given that they are hosted in Github, the code below makes sure that any package in the PIP workflow can be installed correctly. ## First specify the packages of interest packages = c(&quot;pipaux&quot;, &quot;pipload&quot;) ## Now load or install&amp;load all package.check &lt;- lapply( packages, FUN = function(x) { if (!require(x, character.only = TRUE)) { pck_name &lt;- paste0(&quot;PIP-Technical-Team/&quot;, x) devtools::install_github(pck_name) library(x, character.only = TRUE) } } ) 2.1 Auxiilary data Even though pipaux has more than 20 functions, most of its features can be executed by using only the pipaux::load_aux and pipaux::update_aux functions. 2.1.1 udpate data the main function of the pipaux package is udpate_aux. The first argument of this function is measure and it refers to the measure data to be loaded. The measures available are cpi, gdp, pce, pfw, pop, and ppp. pipaux::update_aux(measure = &quot;cpi&quot;) #&gt; Data signature is up to date. #&gt; No update performed 2.1.2 Load data Loading auxiliary data is the job of the package pipload through the function pipload::pip_load_aux(), though pipaux also provides pipaux::load_aux() for the same purpose. Notice that, though both function do exactly the same, the loading function from pipload has the prefix pip_ to distinguish it from the one in pipaux. However, we are going to limit the work of pipaux to update auxiliary data and the work of pipload to load data. Thus, all the examples below use pipload for loading either microdata or auxiliary data. df &lt;- pipload::pip_load_aux(measure = &quot;cpi&quot;) head(df) #&gt; country_code surveyid_year reference_year cpi ccf cpi_domain cpi_data_level #&gt; 1 AGO 2000 2000.21 0.033848061 1 1 2 #&gt; 2 AGO 2008 2008.50 0.723337197 1 1 2 #&gt; 3 AGO 2018 2018.17 3.060594983 1 1 2 #&gt; 4 ALB 1996 1996.00 0.444432734 1 1 2 #&gt; 5 ALB 2002 2002.00 0.780287716 1 1 2 #&gt; 6 ALB 2005 2005.00 0.838473458 1 1 2 2.2 Microdata Loading PIP microdata is the most practical action in the pipload package. However, it is important to understand the logic of microdata. PIP microdata has several characteristics, There could be more than once survey for each Country/Year. This happens when there are more than one welfare variable available such as income and consumption. Some countries, like Mexico, have the two different welfare types in the same survey for the same country/year. This add a layer of complexity when the objective is to known which is default one. There are multiple version of the same harmonized survey. These version are organized in a two-type vintage control. It is possible to have a new version of the data because the Raw data–the one provided by the official NSO–has been updated, or because there has been un update in the harmonization process. Each survey could be use for more than one analytic tool in PIP (e.g., Poverty Calculator, Table Maker, or SOL). Thus, the data to be loaded depends on the tool in which it is going to be used. Thus, in order to make the process of finding and loading data efficiently, pipload is a three-step process. 2.2.1 Inventory file The inventory file resides in y:/PIP-Data/_inventory/inventory.fst. This file is a data frame with all the microdata available in the PIP structure. It has two main variables, orig and filename. The former refers to the full directory path of the database, whereas the latter is only the file name. the other variables in this data frame are derived from these two. The inventory file is used to speed up the file searching process in pipload. In previous packages, each time the user wanted to find a particular data base, it was necessary to look into the folder structure and extract the name of all the file that meet a particular criteria. This is time-consuming and inefficient. The advantage of this method though, is that, by construction, it finds all the the data available. By contrast, the inventory file method is much faster than the “searching” method, as it only requires to load a light file with all the data available, filter the data, and return the required information. The drawback, however, is that it needs to be kept up to date as data changes constantly. To update the inventory file, you need to use the function pip_update_inventory. If you don’t provide any argument, it will update the whole inventory, which may take around 10 to 15 min–the function will warn you about it. By provide the country/ies you want to update, the process is way faster. # update one country pip_update_inventory(&quot;MEX&quot;) #&gt; Data signature is up to date. #&gt; No update performed # Load inventory file df &lt;- pip_load_inventory() head(df[, &quot;filename&quot;]) #&gt; filename #&gt; 1: AFG_2007_NRVA_V01_M_V05_A_PIP_PC-GPWG.dta #&gt; 2: AFG_2007_NRVA_V01_M_V05_A_PIP_TB-ALL.dta #&gt; 3: AFG_2011_NRVA_V01_M_V05_A_PIP_PC-GPWG.dta #&gt; 4: AFG_2011_NRVA_V01_M_V05_A_PIP_TB-ALL.dta #&gt; 5: AGO_2000_HBS_V01_M_V01_A_PIP_PC-GPWG.dta #&gt; 6: AGO_2008_IBEP-MICS_V02_M_V02_A_PIP_PC-GPWG.dta 2.2.2 Finding data Every dataset in the PIP microdata repository is identified by seven variables! Country code, survey year, survey acronym, master version, alternative version, tool, and source. So giving the user the responsibility to know all the different combinations of each file is a heavy burden. Thus, the data finder, pip_find_data(), will provide the names of all the files available that meet the criteria in the arguments provided by the user. For instance, if the use wants to know the all the file available for Paraguay, we could type, pip_find_data(country = &quot;PRY&quot;)[[&quot;filename&quot;]] #&gt; [1] &quot;PRY_1990_EH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_1995_EH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; #&gt; [3] &quot;PRY_1997_EIH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_1999_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; #&gt; [5] &quot;PRY_2001_EIH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2001_EIH_v01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [7] &quot;PRY_2002_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2002_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [9] &quot;PRY_2003_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2003_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [11] &quot;PRY_2004_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2004_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [13] &quot;PRY_2005_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2005_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [15] &quot;PRY_2006_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2006_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [17] &quot;PRY_2007_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2007_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [19] &quot;PRY_2008_EPH_V01_M_V04_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2008_EPH_V01_M_V04_A_PIP_TB-ALL.dta&quot; #&gt; [21] &quot;PRY_2009_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2009_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; #&gt; [23] &quot;PRY_2010_EPH_V01_M_V05_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2010_EPH_V01_M_V05_A_PIP_TB-ALL.dta&quot; #&gt; [25] &quot;PRY_2011_EPH_V01_M_V06_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2011_EPH_V01_M_V06_A_PIP_TB-ALL.dta&quot; #&gt; [27] &quot;PRY_2012_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2012_EPH_V01_M_V03_A_PIP_TB-ALL.dta&quot; #&gt; [29] &quot;PRY_2013_EPH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2013_EPH_V01_M_V02_A_PIP_TB-ALL.dta&quot; #&gt; [31] &quot;PRY_2014_EPH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2014_EPH_V01_M_V02_A_PIP_TB-ALL.dta&quot; #&gt; [33] &quot;PRY_2015_EPH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2015_EPH_V01_M_V02_A_PIP_TB-ALL.dta&quot; #&gt; [35] &quot;PRY_2016_EPH_V01_M_V01_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2016_EPH_V01_M_V01_A_PIP_TB-ALL.dta&quot; #&gt; [37] &quot;PRY_2017_EPH_V01_M_V01_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2017_EPH_V01_M_V01_A_PIP_TB-ALL.dta&quot; #&gt; [39] &quot;PRY_2018_EPH_V01_M_V02_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2018_EPH_V01_M_V02_A_PIP_TB-ALL.dta&quot; Yet, if the user need to be more precise in its request, she can add information to the different arguments of the function. For example, this is data available in 2012, pip_find_data(country = &quot;PRY&quot;, year = 2012)[[&quot;filename&quot;]] #&gt; [1] &quot;PRY_2012_EPH_V01_M_V03_A_PIP_PC-GPWG.dta&quot; &quot;PRY_2012_EPH_V01_M_V03_A_PIP_TB-ALL.dta&quot; 2.2.3 Loading data Function pip_load_data takes care of loading the data. The very first instruction within pip_load_data is to find the data avialable in the repository by using pip_load_inventory(). The difference however is two-fold. First, pip_load_data will load the default and/or most recent version of the country/year combination available. Second, it gives the user the possibility to load different datasets in either list or dataframe form. For instance, if the user wants to load the Paraguay data in 2014 and 2015 used in the Poverty Calculator tool, she may type, df &lt;- pip_load_data(country = &quot;PRY&quot;, year = c(2014, 2015), tool = &quot;PC&quot;) janitor::tabyl(df, survey_id) #&gt; survey_id n percent #&gt; PRY_2014_EPH_V01_M_V02_A_PIP_PC-GPWG 20109 0.39548834 #&gt; PRY_2015_EPH_V01_M_V02_A_PIP_PC-GPWG 30737 0.60451166 "],
["references.html", "References", " References "]
]
